SELECT c.test_id, c.tuple_id, c.episode_number, c.greedy_reward , c.reward FROM rlAgent.rewards c INNER JOIN ( SELECT  min(a.episode_number) episode_number , a.tuple_id FROM rlAgent.rewards a INNER JOIN(SELECT tuple_id, MAX(greedy_reward) greedy_reward FROM rlAgent.rewards where test_id = 29 GROUP BY tuple_id) b where a.tuple_id = b.tuple_id AND a.greedy_reward = b.greedy_reward GROUP BY tuple_id) d where c.tuple_id = d.tuple_id AND c.episode_number = d.episode_number
